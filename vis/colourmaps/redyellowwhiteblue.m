%% Return a colormap array [m,3] -- sequential, shades of red-yellow-white-blue.
%
%
% ARGUMENTS:
%    m -- number of colours in colormap.
%
% OUTPUT:
%    c -- [m,3] colourmap array.
%
% REQUIRES:
%
% AUTHOR:
%     Paula Sanz-Leon (2018-12-21).
%
% USAGE:
%{
    cmap = redyellowwhiteblue(64);
%}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [c] = redyellowwhiteblue(m, mode)
    %% If number of colours (m) not specified, try setting from current colormap.
    if nargin < 1
       f = get(groot, 'CurrentFigure');
       if isempty(f)
          m = size(get(groot, 'DefaultFigureColormap'), 1);
       else
          m = size(f.Colormap, 1);
       end
    end
    
    if nargin < 2 
        mode='dir';
    end


   
    bcm =[ 0,        0,         0.5625; ...
           0,        0,         0.6500; ...
           0,        0,         0.7375; ...
           0,        0,         0.8250; ...
           0,        0,         0.9125; ...
           0,        0,         1.0000; ...
           0,        0.0909,    1.0000; ...
           0,        0.1818,    1.0000; ...
           0,        0.2727,    1.0000; ...
           0,        0.3636,    1.0000; ...
           0,        0.4545,    1.0000; ...
           0,        0.5455,    1.0000; ...
           0,        0.6364,    1.0000; ...
           0,        0.7273,    1.0000; ...
           0,        0.8182,    1.0000; ...
           0,        0.9091,    1.0000; ...
           0,        1.0000,    1.0000; ...
           0.0859,   0.9971,    0.9954; ...
           0.1718,   0.9943,    0.9907; ...
           0.2578,   0.9914,    0.9861; ...
           0.3437,   0.9886,    0.9815; ...
           0.4296,   0.9857,    0.9768; ...
           0.5155,   0.9829,    0.9722; ...
           0.6014,   0.9800,    0.9676; ...
           0.6873,   0.9772,    0.9629; ...
           0.7733,   0.9743,    0.9583; ...
           0.8592,   0.9715,    0.9537; ...
           0.9451    0.9686,    0.9490; ...
           0.9497    0.9712,    0.8699; ...
           0.9542    0.9739,    0.7908; ...
           0.9588    0.9765,    0.7118; ...
           0.9634    0.9791,    0.6327; ...
           0.9680    0.9817,    0.5536; ...
           0.9725    0.9843,    0.4745; ...
           0.9771    0.9869,    0.3954; ...
           0.9817    0.9895,    0.3163; ...
           0.9863    0.9922,    0.2373; ...
           0.9908    0.9948,    0.1582; ...
           0.9954    0.9974,    0.0791; ...
           1.0000    1.0000,    0; ...
           1.0000    0.9091,    0; ...
           1.0000    0.8182,    0; ...
           1.0000    0.7273,    0; ...
           1.0000    0.6364,    0; ...
           1.0000    0.5455,    0; ...
           1.0000    0.4545,    0; ...
           1.0000    0.3636,    0; ...
           1.0000    0.2727,    0; ...
           1.0000    0.1818,    0; ...
           1.0000    0.0909,    0; ...
           1.0000    0,         0; ...
           0.9125    0,         0; ...
           0.8250    0,         0; ...
           0.7375    0,         0; ...
           0.6500    0,         0; ...
           0.5625    0,         0];

    %% Number of colours in basis colormap.
    nc = size(bcm, 1);

    %% Colour step size to produce m colours for output.
    cstep = (nc - 1) / (m - 1);

    %% Linear interpolation of basis colormap.
    c = interp1(1:nc, bcm, 1:cstep:nc);
    
    if strcmp(mode, 'rev') % reverse colormap 
        c = c(end:-1:1, :);
    end
end % function redyellowwhiteblue()
